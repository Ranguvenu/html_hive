{"version":3,"sources":["../src/event_popup.js"],"names":["define","$","Str","ModalFactory","ModalEvents","popup_eventinfo","args","btn","event_details","pop_desc","eventlocal_eventname","eventeventtype","eventlocal_eventenddate","eventlocal_eventstartdate","eventtrainer","eventlocation","eventplugin","eventenrolled","eventself_enrol","button_classroom","tmp","ajax","async","type","global","dataType","url","M","cfg","wwwroot","eventinstance","success","returndata","button_program","button_certification","create","title","body","footer","done","modal","show","getRoot","on","hidden","setTimeout","destroy","bind","load"],"mappings":"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","sourcesContent":["/**\n * Add a create new event modal to the page.\n *\n * @module     blocks/my calendar\n * @package    calendar\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/str', 'core/modal_factory', 'core/modal_events', 'core/fragment', 'core/ajax', 'core/yui'],\n        function($, Str, ModalFactory, ModalEvents) {\n \n    return  {\n        popup_eventinfo: function(args){\n            var btn = '';\n            var event_details = '';\n            var pop_desc =  args.eventlocal_eventname;\n            if (args.eventeventtype == \"session_open\" || args.eventeventtype == \"open\") {\n                if (args.eventlocal_eventenddate == 'null') {\n                     event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\"> Opens on ' + args.eventlocal_eventstartdate+ '</div></div>';\n                } else {\n                    event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\">' + args.eventlocal_eventstartdate+ ' - '+ args.eventlocal_eventenddate+ '</div></div>';\n                }\n            } else if (args.eventeventtype == \"session_close\" || args.eventeventtype == \"close\") {\n                event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\"> Closes on ' + args.eventlocal_eventenddate+ '</div></div>';\n            }\n\n            event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-align-left fa-fw \" aria-hidden=\"true\" title=\"Trainers\" aria-label=\"Trainers\"></i></i> </div><div class=\"col-11\">' + args.eventtrainer + '</div></div>';\n            event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-map-marker fa-fw \" aria-hidden=\"true\" title=\"Location\" aria-label=\"Location\"></i> </div><div class=\"col-11\">' + args.eventlocation + '</div></div>';\n           \n            btn += '<ul class=\"eventpopup_footer\">';\n            switch (args.eventplugin) {\n                case 'local_classroom':\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {                                            \n                        var button_classroom = function () {\n                            var tmp = null;\n                            $.ajax({\n                                async: false,\n                                type: \"POST\",\n                                global: false,\n                                dataType: \"json\",\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_classroom',\n                                success: function (returndata) {\n                                    if ((returndata == 1)) {\n                                      tmp = '<li><a href= \"javascript:void(0)\" onclick=\"(function(e){ require(\\'local_classroom/classroom\\').ManageclassroomStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', classroomid:'+args.eventinstance+',actionstatusmsg:\\'classroom_self_enrolment\\',classroomname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\n                                    } else {\n                                       tmp = '<li>Not published</li>';\n                                    }\n                                }\n                            });\n                            return tmp;\n                        }();\n                        btn += button_classroom;\n                        \n                    }\n                    \n                    else if(args.eventenrolled == true) {\n                       btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/classroom/view.php?cid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\n                    }\n                break;\n                case 'local_program':\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {\n                        var button_program = function () {\n                            var tmp = null;\n                            $.ajax({\n                                async: false,\n                                type: \"POST\",\n                                global: false,\n                                dataType: \"json\",\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_program',\n                                success: function (returndata) {                         \n                                    if ((returndata == 1)) {                                \n                                      tmp = '<li><a href= \"javascript:void(0)\" onclick=\"(function(e){ require(\\'local_program/program\\').ManageprogramStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', programid:'+args.eventinstance+',actionstatusmsg:\\'program_self_enrolment\\',programname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\n                                    } else {\n                                       tmp = '<li>Not published</li>';\n                                    }\n                                }\n                            });\n                            return tmp;\n                        }();\n                        btn += button_program;\n                    }\n                    \n                    else if(args.eventenrolled == true)\n                    btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/program/view.php?bcid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\n                break;\n                case 'local_certification':\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {\n                        var button_certification = function () {\n                            var tmp = null;\n                            $.ajax({\n                                async: false,\n                                type: \"POST\",\n                                global: false,\n                                dataType: \"json\",\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_certification',\n                                success: function (returndata) {                      \n                                    if ((returndata == 1)) {                                \n                                      tmp = '<li><a href= \"javascript:void(0)\"  onclick=\"(function(e){ require(\\'local_certification/certification\\').ManagecertificationStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', certificationid:'+args.eventinstance+',actionstatusmsg:\\'certification_self_enrolment\\',certificationname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\n                                    } else {\n                                       tmp = '<li>Not published</li>';\n                                    }\n                                }\n                            });\n                            return tmp;\n                        }();\n                        btn += button_certification;\n                    }\n                    \n                    else if(args.eventenrolled == true)\n                    btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/certification/view.php?ctid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\n                break;\n                default:\n                btn += '<li><a href=\"'+ M.cfg.wwwroot+'\" target=\"_blank\"></li>';\n            }\n            btn += '</ul>';\n\n            ModalFactory.create({\n                title: pop_desc,\n                body: event_details,\n                footer: btn\n              }).done(function(modal) {\n                modal.show();\n                modal.getRoot().on(ModalEvents.hidden, function() {\n                    setTimeout(function(){\n                    modal.destroy();\n                 }, 1000);\n                }.bind(this));\n            });\n        },\n        load: function () {\n            // do nothing\n        }\n    };\n});"],"file":"event_popup.min.js"}