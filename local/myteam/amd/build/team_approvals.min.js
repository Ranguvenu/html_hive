define ("local_myteam/team_approvals",["core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","jquery"],function(a,b,c,d,e,f){return{init:function init(){},requestsearch:function requestsearch(a){var b=a.learningtype,c=f("input[name=\"approval_learning_type\"]").val();if(c){b=c}var g=a.searchvalue;if("undefined"==typeof g||null==g){return!1}var a={};a.action="searchdata";a.learningtype=b;a.search=g;var h=d.call([{methodname:"local_myteam_teamapprovals_view",args:a}]);h[0].done(function(a){var b=e.render("local_myteam/requestsearch",{response:a});b.then(function(a){f("#team_requests_list").html(a)})}).fail(function(a){console.log(a)})},select_learningtype:function select_learningtype(a){var b=a.learningtype,c=a.pluginname;f("input[name=\"approval_learning_type\"]").val(b);f("input[name=\"search_requests\"]").val("");f(".team_learningtype_dropdown").html(c);var a={};a.action="change_learningtype";a.learningtype=b;a.search=!1;var g=d.call([{methodname:"local_myteam_teamapprovals_view",args:a}]);g[0].done(function(a){var b=e.render("local_myteam/requestsearch",{response:a});b.then(function(a){f("#team_requests_list").html(a)})}).fail(function(a){console.log(a)})},select_request:function select_request(a){var b=a.learningtype,c=a.requestid,d=a.element.checked,e=!1;if(0<c){if(!0==d){e=!0}}if(!0==e){f(".request_approval_btn").prop("disabled",!1)}else{f(".request_approval_btn").prop("disabled",!0)}},approve_request:function approve_request(){var e=f("#approval_learning_type").val(),g=[];f("input[name=\"search_learningtypes\"]").val("");f("input[name=\"team_requests[]\"]:checked").each(function(){var a=f(this).val();g.push(a)});console.log(g);if(!e.length){b.create({title:a.get_string("warning"),type:b.types.DEFAULT,body:a.get_string("select_learningtype","local_myteam")}).done(function(b){b.setSaveButtonText(a.get_string("approve","local_myteam"));var d=a.get_string("reject","local_myteam"),e=b.getFooter().find("[data-action=\"cancel\"]");b.asyncSet(d,e.text.bind(e));b.show();b.getRoot().on(c.hidden,function(){b.destroy()});b.getRoot().on(c.cancel,function(){b.destroy()})});return!1}if(!g.length){b.create({title:a.get_string("warning"),type:b.types.DEFAULT,body:a.get_string("select_requests","local_myteam")}).done(function(b){b.setSaveButtonText(a.get_string("approve","local_myteam"));var d=a.get_string("reject","local_myteam"),e=b.getFooter().find("[data-action=\"cancel\"]");b.asyncSet(d,e.text.bind(e));b.show();b.getRoot().on(c.hidden,function(){b.destroy()});b.getRoot().on(c.cancel,function(){b.destroy()})});return!1}b.create({title:a.get_string("confirm"),type:b.types.SAVE_CANCEL,body:a.get_string("team_request_confirm","local_myteam")}).done(function(b){b.setSaveButtonText(a.get_string("approve","local_myteam"));var h=a.get_string("reject","local_myteam"),i=b.getFooter().find("[data-action=\"cancel\"]");b.asyncSet(h,i.text.bind(i));b.show();b.getRoot().on(c.hidden,function(){b.destroy()});b.getRoot().on(c.save,function(){var a={action:"requestapproved",requeststoapprove:JSON.stringify(g),learningtype:e},c=d.call([{methodname:"local_myteam_teamapprovals_actions",args:a}]);c[0].done(function(){f("#allocation_notifications").html("<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">\xD7</button>Selected learning types has been allocated.</div>");b.hide();b.destroy();window.location.href=window.location.href}).fail(function(a){console.log(a)})});b.getRoot().on(c.cancel,function(){setTimeout(function(){b.destroy()},1e3)})})}}});
//# sourceMappingURL=team_approvals.min.js.map
