function _typeof(a){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("local_myteam/courseallocation",["core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","jquery"],function(a,b,c,d,e,f){return{init:function init(){f(".allocate_button").prop("disabled",!0);f(".allocation_course_type_btn").prop("disabled",!0)},teamsearch:function teamsearch(a){var b=a.searchtype,c=a.searchvalue;if("undefined"==typeof c){return!1}var g=f("input[name='allocateuser']:checked").val();if("myteam"===b){var h=".departmentmyteam",i=f("#nominate_myteamlist").val(),a={};a.action="searchdata";a.learningtype=b;a.search=c;a.user="";var j=d.call([{methodname:"local_myteam_teamallocation_view",args:a}]);j[0].done(function(a){var b=e.render("local_myteam/searchallocateusers",{response:a});b.then(function(a){f(".departmentmyteam").html(a)})}).fail(function(a){console.log(a)})}else{var h=".departmentcourses",k=f("#nominate_myteamlist").val(),i=f("#nominate_courseslist").val(),l=f("#learning_type").val(),m=f("input[name=\"search_learningtypes\"]").val();if(b!=l){b=l}if(g==void 0||null==g){f(h).html("<div class=\"alert alert-danger\">Select a user to proceed.</div>")}else{var a={};a.action="searchdata";a.learningtype=b;a.search=c;a.user=k;a.allocatecourse=!1;var j=d.call([{methodname:"local_myteam_courseallocation_view",args:a}]);j[0].done(function(a){var b=e.render("local_myteam/courseallocatemoduledata",{response:a});b.then(function(a){f(".departmentcourses").html(a)})}).fail(function(a){console.log(a)})}}},select_type:function select_type(g){var h=g.user,i=g.learningtype,j=g.pluginname;f("input[name=\"search_learningtypes\"]").val("");f("#learning_type").val(g.learningtype);if(null!=h&&_typeof(h)!=void 0){f("#nominate_myteamlist").val(h)}var k=f("input[name=\"allocateuser\"]:checked").val();if(h==void 0&&null==k){b.create({title:a.get_string("warning"),type:b.types.DEFAULT,body:a.get_string("team_select_user","local_myteam")}).done(function(a){a.show();a.getRoot().on(c.hidden,function(){a.destroy()});a.getRoot().on(c.cancel,function(){a.destroy()})});return!1}else{h=k}switch(i){case 1:type=j;break;case 2:type=j;break;case 3:type=j;break;case 4:type=j;break;default:type=j;break;}f(".allocation_course_type").html(type);var g={action:"departmentmodules",learningtype:i,user:h,search:!1,allocatecourse:!1},l=d.call([{methodname:"local_myteam_courseallocation_view",args:g}]);l[0].done(function(a){var b=e.render("local_myteam/courseallocatemoduledata",{response:a});b.then(function(a){f(".departmentcourses").html(a)})}).fail(function(a){console.log(a)})},select_list:function select_list(a){var b=a.user,c=a.courses,d=a.learningtype,e=a.element.checked,g=f("#nominate_courseslist").val(),h=f("input[name=\"allocatecourse\"]:checked").val();f("input[name=\"search_learningtypes\"]").val("");var i=!1;switch(d){case 1:if(1<c){if(!0==e){i=!0}}break;case 2:if(c){if(!0==e){i=!0}}break;case 3:if(1<c){if(!0==e){i=!0}}break;case 4:if(1<c){if(!0==e){i=!0}}break;default:i=!1;break;}if(!0==i){f(".allocate_button").prop("disabled",!1);f(".allocation_course_type_btn").prop("disabled",!1)}else{f(".allocate_button").prop("disabled",!0);f(".allocation_course_type_btn").prop("disabled",!0)}switch(d){case 1:break;case 2:break;case 3:break;case 4:break;default:break;}},allocator:function allocator(){var g=f("#nominate_myteamlist").val(),h=f("#learning_type").val(),i=[];f("input[name=\"search_learningtypes\"]").val("");f("input[name=\"allocatecourse[]\"]:checked").each(function(){var a=f(this).val();i.push(a)});if(!g.length){b.create({title:a.get_string("warning"),type:b.types.DEFAULT,body:a.get_string("team_select_user","local_myteam")}).done(function(a){a.show();a.getRoot().on(c.hidden,function(){a.destroy()});a.getRoot().on(c.cancel,function(){a.destroy()})});return!1}if(!i.length){b.create({title:a.get_string("warning"),type:b.types.DEFAULT,body:a.get_string("team_select_course_s","local_myteam")}).done(function(a){a.show();a.getRoot().on(c.hidden,function(){a.destroy()});a.getRoot().on(c.cancel,function(){a.destroy()})});return!1}b.create({title:a.get_string("team_confirm_selected_allocation","local_myteam"),type:b.types.SAVE_CANCEL,body:a.get_string("allocate_confirm_allocate","local_myteam")}).done(function(b){this.modal=b;b.setSaveButtonText(a.get_string("allocate_yes","local_myteam"));var e=a.get_string("reject_no","local_myteam"),j=this.modal.getFooter().find("[data-action=\"cancel\"]");this.modal.asyncSet(e,j.text.bind(j));b.getRoot().on(c.save,function(a){this.modal.setBody("<span class=\"loading-icon icon-no-margin\"><img src="+M.cfg.wwwroot+"/local/ajax-loader.svg></span>");this.modal.hideFooter();this.modal.setTitle("Request Processing...");f("[data-action=\"hide\"]").css("display","none");a.preventDefault();var c={action:"courseallocate",learningtype:h,user:g,search:!1,allocatecourse:JSON.stringify(i)},e=d.call([{methodname:"local_myteam_modulecourse_allocation",args:c}]);e[0].done(function(a){var c="";f.each(a.records,function(a,b){if(!0==b.enrolledornot&&""!=b.return_status){c=c+b.return_status}else if(!0==b.enrolledornot&&""==b.return_status){if(c!="<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">\xD7</button>Selected learning types has been allocated.</div>"){c=c+"<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">\xD7</button>Selected learning types has been allocated.</div>"}}});b.setBody(c);b.setTitle("Information");f("[data-action=\"hide\"]").css("display","block");f(".close").click(function(){location.reload()})}).fail(function(a){console.log(a)})}.bind(this));b.show()}.bind(this))},load:function load(){}}});
//# sourceMappingURL=courseallocation.min.js.map
