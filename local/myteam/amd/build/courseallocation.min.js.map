{"version":3,"sources":["../src/courseallocation.js"],"names":["define","Str","ModalFactory","ModalEvents","Ajax","Templates","$","init","prop","teamsearch","params","searchtype","search","searchvalue","user","val","target","selectedcontent","action","learningtype","promise","call","methodname","args","done","resp","data","render","response","then","html","fail","ex","console","log","selecteduser","learningtype_search","allocatecourse","select_type","pluginname","selected_user","create","title","get_string","type","types","DEFAULT","body","modal","show","getRoot","on","hidden","destroy","cancel","select_list","courseid","courses","coursecheckedstatus","element","checked","current_courses","selected_courses","allocate","allocator","allocateuser","each","courseid_selected","push","length","SAVE_CANCEL","setSaveButtonText","value","button","getFooter","find","asyncSet","text","bind","save","e","setBody","M","cfg","wwwroot","hideFooter","setTitle","css","preventDefault","JSON","stringify","bobytext","records","index","enrolledornot","return_status","click","location","reload","load"],"mappings":"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","sourcesContent":["/**\n * Add a create new group modal to the page.\n *\n * @module     core_group/AjaxForms\n * @class      AjaxForms\n * @package    core_group\n * @copyright  2017 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/ajax',\n    'core/templates',\n    'jquery',\n], function(Str, ModalFactory, ModalEvents, Ajax, Templates, $) {\n    var courseallocation;\n    return {\n        init: function() {\n            $('.allocate_button').prop( \"disabled\", true );\n            $('.allocation_course_type_btn').prop( \"disabled\", true );\n        },\n        teamsearch: function(params) {\n            var searchtype = params.searchtype;\n            var search = params.searchvalue;\n            if(typeof(search) == 'undefined'){\n                return false;\n            }\n            var user = $(\"input[name='allocateuser']:checked\").val();\n            if(searchtype === 'myteam'){\n                var target = '.departmentmyteam';\n                var selectedcontent = $('#nominate_myteamlist').val();\n\n                var params = {};\n                params.action = 'searchdata';\n                params.learningtype = searchtype;\n                params.search = search;\n                params.user = '';\n\n                var promise = Ajax.call([{\n                    methodname: 'local_myteam_teamallocation_view',\n                    args: params\n                }]);\n                promise[0].done(function(resp) {\n                    var data = Templates.render('local_myteam/searchallocateusers', {response: resp});\n                    data.then(function(response){\n                         $(\".departmentmyteam\").html(response);\n                    });\n                }).fail(function(ex) {\n                    // do something with the exception\n                    console.log(ex);\n                });\n            }else{\n                var target = '.departmentcourses';\n                var selecteduser = $('#nominate_myteamlist').val();\n                var selectedcontent = $('#nominate_courseslist').val();\n                var learningtype = $('#learning_type').val();\n                var learningtype_search = $('input[name=\"search_learningtypes\"]').val();\n                if(searchtype != learningtype){\n                    searchtype = learningtype;\n                }\n                if(user == undefined || user == null){\n                    var data = '<div class=\"alert alert-danger\">Select a user to proceed.</div>'\n                    $(target).html(data);\n                }else{\n                    var params = {};\n                    params.action = 'searchdata';\n                    params.learningtype = searchtype;\n                    params.search = search;\n                    params.user = selecteduser;\n                    params.allocatecourse = false;\n\n                    var promise = Ajax.call([{\n                        methodname: 'local_myteam_courseallocation_view',\n                        args: params\n                    }]);\n                    promise[0].done(function(resp) {\n                        var data = Templates.render('local_myteam/courseallocatemoduledata', {response: resp});\n                        data.then(function(response){\n                             $(\".departmentcourses\").html(response);\n                        });\n                    }).fail(function(ex) {\n                        // do something with the exception\n                        console.log(ex);\n                    });\n                }\n            }\n        },\n        select_type: function(params) {\n            var user = params.user;\n            var learningtype = params.learningtype;\n            var pluginname = params.pluginname;\n\n            $('input[name=\"search_learningtypes\"]').val('');\n            $('#learning_type').val(params.learningtype);\n            \n            if(user != null && typeof(user) != undefined){\n                $('#nominate_myteamlist').val(user);\n            }\n\n            var selected_user = $('input[name=\"allocateuser\"]:checked').val();\n\n            if(user == undefined && selected_user == null){\n\n                ModalFactory.create({\n                    title: Str.get_string('warning'),\n                    type: ModalFactory.types.DEFAULT,\n                    body: Str.get_string('team_select_user', 'local_myteam')\n                }).done(function(modal) {\n                    // Do what you want with your new modal.\n                    modal.show();\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        modal.destroy();\n                    });\n                    modal.getRoot().on(ModalEvents.cancel, function() {\n                        modal.destroy();\n                    });\n                     //return modal;\n                });\n                return false;\n            }else{\n                user = selected_user;\n            }\n\n            switch(learningtype){\n                case 1:\n                    type = pluginname;\n                break;\n                case 2:\n                    type = pluginname;\n                break;\n                case 3:\n                    type = pluginname;\n                break;\n                case 4:\n                    type = pluginname;\n                break;\n                default:\n                    type = pluginname;\n                break;\n            }\n            $('.allocation_course_type').html(type);\n            var params = {};\n            params.action = 'departmentmodules';\n            params.learningtype = learningtype;\n            params.user = user;\n            params.search = false;\n            params.allocatecourse = false;\n\n            var promise = Ajax.call([{\n                methodname: 'local_myteam_courseallocation_view',\n                args: params\n            }]);\n            promise[0].done(function(resp) {\n                var data = Templates.render('local_myteam/courseallocatemoduledata', {response: resp});\n                data.then(function(response){\n                     $(\".departmentcourses\").html(response);\n                });\n            }).fail(function(ex) {\n                // do something with the exception\n                console.log(ex);\n            });\n        },\n        select_list: function(params) {\n            var user = params.user;\n            var courseid = params.courses;\n            var learningtype = params.learningtype;\n            var coursecheckedstatus = params.element.checked;\n\n            var current_courses = $('#nominate_courseslist').val();\n            var selected_courses = $('input[name=\"allocatecourse\"]:checked').val();\n            $('input[name=\"search_learningtypes\"]').val('');\n            \n            var allocate = false;\n\n            switch(learningtype){\n                case 1:\n                    if(courseid > 1){\n                        if(coursecheckedstatus == true){\n                            allocate = true;\n                        }\n                    }\n                break;\n                case 2:\n                    if(courseid){\n                        if(coursecheckedstatus == true){\n                            allocate = true;\n                        }\n                    }\n                break;\n                case 3:\n                    if(courseid > 1){\n                        if(coursecheckedstatus == true){\n                            allocate = true;\n                        }\n                    }\n                break;\n                case 4:\n                    if(courseid > 1){\n                        if(coursecheckedstatus == true){\n                            allocate = true;\n                        }\n                    }\n                break;\n                default:\n                    allocate = false;\n                break;\n            }\n            \n            if(allocate == true){\n                $('.allocate_button').prop( \"disabled\", false);\n                $('.allocation_course_type_btn').prop( \"disabled\", false);\n            }else{\n                $('.allocate_button').prop( \"disabled\", true);\n                $('.allocation_course_type_btn').prop( \"disabled\", true);\n            }\n\n            switch(learningtype){\n                case 1:\n                    \n                break;\n                case 2:\n                    \n                break;\n                case 3:\n                    \n                break;\n                case 4:\n                    \n                break;\n                default:\n                    \n                break;\n            }\n        },\n        allocator: function() {\n            var allocateuser = $('#nominate_myteamlist').val();\n            var learningtype = $('#learning_type').val();\n            var allocatecourse = [];\n            $('input[name=\"search_learningtypes\"]').val('');\n             var selected_courses = $('input[name=\"allocatecourse[]\"]:checked').each(function () {\n                var courseid_selected = $(this).val();\n                allocatecourse.push(courseid_selected);\n             });\n            if(!allocateuser.length){\n                ModalFactory.create({\n                    title: Str.get_string('warning'),\n                    type: ModalFactory.types.DEFAULT,\n                    body: Str.get_string('team_select_user', 'local_myteam')\n                }).done(function(modal) {\n                    // Do what you want with your new modal.\n                    modal.show();\n\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        modal.destroy();\n                    });\n                    modal.getRoot().on(ModalEvents.cancel, function() {\n                        // setTimeout(function(){\n                            modal.destroy();\n                        // }, 1000);\n                    });\n                });\n                return false;\n            }\n            if(!allocatecourse.length){\n\n\n                ModalFactory.create({\n                    title: Str.get_string('warning'),\n                    type: ModalFactory.types.DEFAULT,\n                    body: Str.get_string('team_select_course_s', 'local_myteam')\n                }).done(function(modal) {\n                    // Do what you want with your new modal.\n                    modal.show();\n\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        modal.destroy();\n                    });\n                    modal.getRoot().on(ModalEvents.cancel, function() {\n                        // setTimeout(function(){\n                            modal.destroy();\n                        // }, 1000);\n                    });\n                });\n                return false;\n            }\n\n            ModalFactory.create({\n                title: Str.get_string('team_confirm_selected_allocation', 'local_myteam'),\n                type: ModalFactory.types.SAVE_CANCEL,\n                body: Str.get_string('allocate_confirm_allocate', 'local_myteam')\n            }).done(function(modal) {\n                this.modal = modal;\n                // Do what you want with your new modal.\n                modal.setSaveButtonText(Str.get_string('allocate_yes', 'local_myteam'));\n\n                 //For cancel button string changed//\n                var value=Str.get_string('reject_no', 'local_myteam');\n                var button = this.modal.getFooter().find('[data-action=\"cancel\"]');\n                this.modal.asyncSet(value, button.text.bind(button));\n           \n\n                modal.getRoot().on(ModalEvents.save, function(e) {\n                    this.modal.setBody('<span class=\"loading-icon icon-no-margin\"><img src='+M.cfg.wwwroot + '/local/ajax-loader.svg></span>');\n                    this.modal.hideFooter();\n                    this.modal.setTitle('Request Processing...');\n                    $('[data-action=\"hide\"]').css('display','none');\n                    \n                    e.preventDefault();\n    \n                    var params = {};\n                    params.action = 'courseallocate';\n                    params.learningtype = learningtype;\n                    params.user = allocateuser;\n                    params.search = false;\n                    params.allocatecourse = JSON.stringify(allocatecourse);\n\n\n                    var promise = Ajax.call([{\n                        methodname: 'local_myteam_modulecourse_allocation',\n                        args: params\n                    }]);\n                    promise[0].done(function(resp) {\n                            var bobytext='';\n                         $.each(resp.records, function(index, element) {\n                            if(element.enrolledornot==true && element.return_status !=''){\n                                 bobytext=bobytext+element.return_status;\n                                 //modal.setBody(element.return_status);\n                                 //modal.setTitle('Information');\n                                 //$('[data-action=\"hide\"]').css('display','block');\n                              \n                            }\n                            else if(element.enrolledornot==true && element.return_status ==''){\n                                var textbody='<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>Selected learning types has been allocated.</div>';\n                                if(bobytext!=textbody){\n                                    bobytext=bobytext+textbody;\n                                }\n                                \n                                // $('#allocation_notifications').html('<div class=\"alert alert-info\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>Selected learning types has been allocated.</div>');\n                            }\n                         });\n                        modal.setBody(bobytext);\n                         modal.setTitle('Information');\n                         $('[data-action=\"hide\"]').css('display','block');\n                        \n                        //modal.hide();\n                        //modal.destroy();\n                        //window.location.href = window.location.href;\n                         $(\".close\").click(function(){\n                               location.reload();\n                        });\n\n                    }).fail(function(ex) {\n                        // do something with the exception\n                        console.log(ex);\n                    });\n                    }.bind(this));\n                    modal.show();\n                }.bind(this));\n        },\n        load: function(){\n\n        }\n    };\n});"],"file":"courseallocation.min.js"}