define ("local_assignroles/popup",["local_assignroles/jquery.dataTables","jquery","core/str","core/modal_factory","core/modal_events","core/fragment","core/ajax","core/yui","jqueryui"],function(a,b,c,d,e,f,g){var h=function(a){this.contextid=a.contextid;var b=this;b.init(a.selector)};h.prototype.modal=null;h.prototype.contextid=-1;h.prototype.init=function(a){var f=this;b(a).click(function(){f.roleid=b(this).data("roleid");f.rolename=b(this).data("rolename");c.get_string("assignrole","local_assignroles",f).then(function(a){d.create({type:d.types.CANCEL,title:a,body:f.getBody()}).done(function(a){f.modal=a;f.modal.setLarge();f.modal.getRoot().on(e.hidden,function(){f.modal.hide();f.modal.destroy()}.bind(this));f.modal.getRoot().on(e.cancel,function(){f.modal.hide();f.modal.destroy()}.bind(this));f.modal.show();f.modal.getRoot().on(e.bodyRendered,function(){f.dataTableshow(f.roleid)}.bind(this))})})})};h.prototype.dataTableshow=function(a){b("#popup_user"+a).dataTable({bPaginate:!0,bFilter:!0,bLengthChange:!0,lengthMenu:[[5,10,25,50,100,-1],[5,10,25,50,100,"All"]],language:{emptyTable:"No Records Found",paginate:{previous:"<",next:">"}},bProcessing:!0});b.fn.dataTable.ext.errMode="none"};h.prototype.getBody=function(a){if("undefined"==typeof a){a={}}if("undefined"!=typeof this.roleid){var b={roleid:this.roleid,jsonformdata:JSON.stringify(a)}}else{var b={}}return f.loadFragment("local_assignroles","roleusers_display",this.contextid,b)};var i=function(a){return c.get_strings([{key:"confirmation",component:"local_assignroles"},{key:"unassignconfirm",component:"local_assignroles",param:a},{key:"unassign",component:"local_assignroles"}]).then(function(b){d.create({title:b[0],type:d.types.SAVE_CANCEL,body:b[1]}).done(function(c){this.modal=c;c.setSaveButtonText(b[2]);c.getRoot().on(e.save,function(b){b.preventDefault();a.confirm=!0;console.log(a);var c={contextid:a.contextid,roleid:a.roleid,userid:a.userid},d=g.call([{methodname:"local_assignroles_unassign_role",args:c}]);d[0].done(function(){window.location.href=window.location.href}).fail(function(a){console.log(a)})}.bind(this));c.show()}.bind(this))}.bind(this))};return{init:function init(a){this.Datatable();return new h(a)},Datatable:function Datatable(){},unassignConfirm:function unassignConfirm(a){return i(a)}}});
//# sourceMappingURL=popup.min.js.map
