define ("local_request/requestconfirm",["jquery","core/str","core/modal_factory","core/modal_events","core/fragment","core/ajax","core/yui","local_request/jquery.dataTables"],function(a,b,c,d){var e=function(a){this.componentid=a.componentid;this.component=a.component;this.id=a.id;this.action=a.action;this.init(a)};e.prototype.modal=null;e.prototype.contextid=-1;e.prototype.getrequeststring=function(){return b.get_strings([{key:"confirm"},{key:"request_confirm_message",component:"local_request",param:args},{key:"confirm"}])};e.prototype.handleModalSubmissionResponse=function(c,d,e){if(0==c){var f=b.get_string("alreadyrequested","local_request")}else if(-1==c){var f=b.get_string("capacity_check","local_request")}else{var f=b.get_string("success_"+e.action,"local_request")}if("approve"==e.action&&"Classroom"==e.component){if(1>c||""==c){d.setTitle("Information");d.setBody(f);d.getFooter().find("[data-action=\"cancel\"], [data-action=\"save\"]").hide()}else{this.modal.hideFooter();d.setBody(c);d.setTitle("Information");a("[data-action=\"hide\"]").css("display","block")}}else if("approve"==e.action&&"Certification"==e.component){d.setTitle("Information");d.setBody(f);d.getFooter().find("[data-action=\"cancel\"], [data-action=\"save\"]").hide()}else if("add"!=e.action){window.location.reload()}else{d.setBody(f);d.getFooter().find("[data-action=\"cancel\"], [data-action=\"save\"]").hide()}a(".close").click(function(){location.reload()})};e.prototype.submitajax=function(b,c){this.modal=c;userid=b.userid;if("approve"==b.action){c.setSaveButtonText("Approve")}else if("deny"==b.action){c.setSaveButtonText("Reject")}else if("delete"==b.action){c.setSaveButtonText("Delete")}else{c.setSaveButtonText("Confirm")}c.getRoot().on(d.save,function(d){d.preventDefault();b.confirm=!0;a.ajax({method:"POST",dataType:"json",url:M.cfg.wwwroot+"/local/request/ajax.php",data:{component:b.component,componentid:b.componentid,action:b.action,id:b.id}}).done(function(a){e.prototype.handleModalSubmissionResponse(a,c,b)})})};e.prototype.getbodystring=function(a){var c="";if(a.action&&a.component){var c=b.get_string("confirmmsgfor_"+a.action,"local_request",a)}return c};e.prototype.init=function(b){a.Deferred();this.action=b.action;var d=b.componentid,f=b.userid,g=b.component;c.create({title:"Confirm",type:c.types.SAVE_CANCEL,body:e.prototype.getbodystring(b)}).done(function(a){e.prototype.submitajax(b,a);a.show()})};e.prototype.init11=function(f){var g=f.componentid,h=f.userid,i=f.component;return b.get_strings([{key:"confirm"},{key:"request_confirm_message",component:"local_request",param:f},{key:"confirm"}]).then(function(e){c.create({title:e[0],type:c.types.SAVE_CANCEL,body:e[1]}).done(function(c){this.modal=c;c.setSaveButtonText(e[2]);c.getRoot().on(d.save,function(d){d.preventDefault();a.ajax({method:"GET",dataType:"json",url:M.cfg.wwwroot+"/local/request/ajax.php?component='"+f.component+"'&componentid="+g+"&userid="+h,success:function success(d){if(0==d){var e=b.get_string("alreadyrequested","local_request")}else{var e=b.get_string("requestsent","local_request")}c.setBody(e);c.getFooter().find("[data-action=\"cancel\"], [data-action=\"save\"]").hide();a(".close").click(function(){location.reload()})}})}.bind(this));c.show()}.bind(this))}.bind(this))};return{init:function init(a){return new e(a)},requestDatatable:function requestDatatable(){params=[];params.action="viewrequest";params.classroomid=a("#viewrequest").data("classroomid");a("#viewrequest").dataTable({processing:!1,serverSide:!1,language:{paginate:{next:">",previous:"<"},search:"",searchPlaceholder:"Search"},sorting:!1,responsive:!0,pageLength:5,bLengthChange:!1,bInfo:!1})},load:function load(){}}});
//# sourceMappingURL=requestconfirm.min.js.map
