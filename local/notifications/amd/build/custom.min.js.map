{"version":3,"sources":["../src/custom.js"],"names":["define","dataTable","$","Str","ModalFactory","init","document","on","notificationid","find","val","costcenterid","ajax","method","dataType","url","M","cfg","wwwroot","success","data","html","datastrings","template","each","datamoduleids","index","value","id","name","completion_template","completiondays","css","datamodule_label","page","notificationDatatable","args","params","action","context","deletenotification","elem","get_strings","key","component","then","s","create","title","type","types","DEFAULT","body","footer","done","modal","getRoot","window","location","href","sesskey","bind","getFooter","setBody","hide","show"],"mappings":"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","sourcesContent":["define(['local_notifications/jquery.dataTables', 'jquery', 'core/str', 'core/modal_factory', 'core/modal_events'],\n        function(dataTable, $, Str, ModalFactory) {\n    return {\n        init: function() {\n            $(document).on('change', '#id_notificationid', function() {\n                // console.log('init');\n                var notificationid = $(this).find(\"option:selected\").val();\n                 var costcenterid = $('#id_costcenterid').find(\"option:selected\").val();\n                // console.log(notificationid);\n                if (notificationid !== null) {\n                      $.ajax({\n                        method: \"GET\",\n                        dataType: \"json\",\n                        url: M.cfg.wwwroot + \"/local/notifications/custom_ajax.php?notificationid=\"+notificationid+\"&page=\"+1+\"&costcenterid=\"+costcenterid,\n                        success: function(data){\n                            // console.log(data);\n                            //$(\".form-control-static\").append(JSON.stringify(data));\n                            $(\".form-control-static\").html(data.datastrings);\n                            var template ='';\n                            $.each( data.datamoduleids, function( index, value) {\n                                template += '<option value = ' + value.id + ' >' +value.name + '</option>';\n                           });\n                            var completion_template ='';\n                            $.each( data.completiondays, function( index, value) {\n                                completion_template += '<option value = ' + index + ' >' + value + '</option>';\n                            });\n                            \n                            if(template){\n                                $(\".module_label\").css('display','block');\n                                $(\"div .module_label .tag-info\").html(\"\");\n                                $(\"#id_moduleid\").html(template);\n                                $(\".module_label label\").html(data.datamodule_label);\n                                if(completion_template){\n                                    $('#select_completiondays').html(completion_template);\n                                    $('#completion_reminder_tag').html('Before Completion Days');\n                                }else{\n                                    $('#select_completiondays').html('<option value=0>Select Completion days</option>')\n                                    $('#completion_reminder_tag').html('');\n                                }\n                            }else{\n                                $(\".module_label\").css('display','none');\n                            }\n                            \n                        }\n                    });\n                }\n            });\n            $(document).on('change', '#select_completiondays', function(){\n                var notificationid = $('#id_notificationid').find(\"option:selected\").val();\n                var costcenterid = $('#id_costcenterid').find(\"option:selected\").val();\n                var completiondays = $(this).find(\"option:selected\").val();\n                $.ajax({\n                    method: \"POST\",\n                    dataType: \"json\",\n                    url: M.cfg.wwwroot + \"/local/notifications/custom_ajax.php\",\n                    data : {notificationid: notificationid, page: 4, costcenterid: costcenterid, completiondays: completiondays},\n                    success: function(data){\n                        var template ='';\n                        $.each( data.datamoduleids, function( index, value) {\n                            template += '<option value = ' + value.id + ' >' +value.name + '</option>';\n                        });\n                        if(template){\n                            $(\"#id_moduleid\").html(template);\n                            $(\".module_label label\").html(data.datamodule_label);\n                        }\n                    }\n                });\n            });\n        },\n        notificationDatatable: function(args) {\n            params = [];\n            params.action = 'display';\n            params.id = args.id;\n            params.context = args.context;\n            var oTable = $('#notification_info').dataTable({\n                \"bInfo\" : false,\n                \"bLengthChange\": false,\n                \"order\": [],\n                \"language\": {\n                        \"paginate\": {\n                            \"next\": \">\",\n                            \"previous\": \"<\"\n                        }\n                },\n                \"pageLength\": 10\n            });\n        },\n        deletenotification: function(elem) {\n            return Str.get_strings([{\n                key: 'deletenotification',\n                component: 'local_notifications'\n            }, {\n                key: 'deleteconfirm_msg',\n                component: 'local_notifications'\n            }]).then(function(s) {\n                ModalFactory.create({\n                    title: s[0],\n                    type: ModalFactory.types.DEFAULT,\n                    body: s[1],\n                    footer: '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Yes</button>&nbsp;' +\n        '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">No</button>'\n                }).done(function(modal) {\n                    this.modal = modal;\n                    modal.getRoot().find('[data-action=\"save\"]').on('click', function() {\n                        window.location.href ='index.php?delete='+elem+'&confirm=1&sesskey=' + M.cfg.sesskey;\n                    }.bind(this));\n                    modal.getFooter().find('[data-action=\"cancel\"]').on('click', function() {\n                        modal.setBody('');\n                        modal.hide();\n                    });\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        }\n        \n    };\n});"],"file":"custom.min.js"}