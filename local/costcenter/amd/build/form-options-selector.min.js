define("local_costcenter/form-options-selector",["jquery","core/ajax","core/templates","core/str"],(function($,Ajax,Templates,Str){return{processResults:function(selector,results){var options=[];return $.isArray(results)?($.each(results,(function(index,option){options.push({value:option.id,label:option._label})})),options):results},transport:function(selector,query,success,failure){contextid=parseInt($(selector).data("contextid"),10),action=$(selector).data("action"),formoptions=$(selector).data("options"),Str.get_strings([{key:"selectdept",component:"local_courses"},{key:"selectsubdept",component:"local_courses"},{key:"selectcat",component:"local_courses"}]).then((function(s){var departmentselect="<span><span>"+s[0]+"</span></span>",subdeptartmentselect="<span><span>"+s[1]+"</span></span>",categoryselect="<span><span>"+s[2]+"</span></span>";"costcenter_organisation_selector"===action?$("#id_open_costcenterid").on("change",(function(){var department=$("#id_open_departmentid").val();parseInt(department)>0&&($("#id_open_departmentid").html(""),$(".departmentselect .form-autocomplete-selection .form-autocomplete-selection").html(departmentselect));var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect))})):"costcenter_department_selector"!==action&&"costcenter_subdepartment_selector"!==action||($("#id_open_departmentid").on("change",(function(){var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect))})),$("#id_open_subdepartment").on("change",(function(){var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect))})))})),"costcenter_department_selector"===action||"costcenter_subdepartment_selector"===action?formoptions.parentid=$('[data-class="'+$(selector).data("parentclass")+'"]').val():"costcenter_category_selector"===action&&(formoptions.organisationid=$("#id_open_costcenterid").val(),formoptions.departmentid=$("#id_open_departmentid").val(),formoptions.subdepartment=$("#id_open_subdepartment").val()),formoptions=JSON.stringify(formoptions),Ajax.call([{methodname:"local_costcenter_form_option_selector",args:{query:query,context:{contextid:contextid},action:action,options:formoptions,searchanywhere:!0,page:0,perpage:101}}])[0].then((function(results){results=$.parseJSON(results);var promises=[],i=0;return"local_costcenter/form-option-selector-suggestion",results.length<=100?($.each(results,(function(index,option){var ctx=option;ctx.hasidentity=!0,ctx.identity=[].join(", "),promises.push(Templates.render("local_costcenter/form-option-selector-suggestion",ctx))})),$.when.apply($.when,promises).then((function(){var args=arguments;$.each(results,(function(index,option){option._label=args[i],i++})),success(results)}))):Str.get_string("toomanyoptionstoshow","local_costcenter",">100").then((function(toomanyoptionstoshow){success(toomanyoptionstoshow)}))})).fail(failure)}}}));

//# sourceMappingURL=form-options-selector.min.js.map