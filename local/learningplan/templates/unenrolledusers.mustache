{{!
This file is part of Moodle - http://moodle.org/

Moodle is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Moodle is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Moodle. If not, see
<http: //www.gnu.org/licenses />.
}}
<style>
    .show-read-more .more-text {
        display: none;
    }
</style>
<a href = "{{downloadurl}}" class = "pull-right" style="cursor:pointer">Download CSV</a>

<table id="unenrol_lpaths" class="generaltable dataTable no-footer">
    <thead class="text-white text-center">
        <tr>
            <th>{{#str}}pluginname, local_learningplan{{/str}}</th>            
            <th>{{#str}}uname, local_learningplan{{/str}}</th>
            <th>{{#str}}email, local_learningplan{{/str}}</th>
            <th>{{#str}}reason, local_learningplan{{/str}}</th>
            <th>{{#str}}undate, local_learningplan{{/str}}</th>
        </tr>
    </thead>

    <tbody align="center">
        {{# data}}
        <tr>
            <td><a href = "{{configpath}}/local/learningplan/plan_view.php?id={{lpid}}" target= "_blank">{{name}}</td>            
            <td>{{username}}</td>
            <td>{{email}}</td>
            <td class="show-read-more" style="word-wrap: break-word;
                width: 30%;">{{unenrol_reason}}</td>
            <td>{{time}}</td>
        </tr>
        {{/ data}}
    </tbody>
</table>
<script>
    $(document).ready(function () {
        var maxLength = 100;
        $(".show-read-more").each(function () {
            var myStr = $(this).text();
            if ($.trim(myStr).length > maxLength) {
                var newStr = myStr.substring(0, maxLength);
                var removedStr = myStr.substring(maxLength, $.trim(myStr).length);
                $(this).empty().html(newStr);
                $(this).append(' <a href="javascript:void(0);" class="read-more">...</a>');
                $(this).append('<span class="more-text">' + removedStr + '</span>');
            }
        });
        $(".read-more").click(function () {
            $(this).siblings(".more-text").contents().unwrap();
            $(this).remove();

        });

    });
</script>